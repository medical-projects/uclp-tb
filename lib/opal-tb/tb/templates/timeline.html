<div class="panel panel-default">
  <div class="panel-heading">
    <h3>
        Patient History
    </h3>
  </div>
  <div class="panel-body">
    <div ng-if="$first" class="row">
      <div class="col-md-3 patient-timeline">
        <div class="patient-timeline-now">
          <div class="patient-timeline-now-text bg-secondary">
            Now
          </div>
        </div>
      </div>
    </div>
    <div ng-repeat="date in dates" class="row content-offset-20">
      <div class="col-md-2 patient-timeline">
        <div style="background-color: #f76c51; color: white; border-radius: 50%; height: 70px; width: 70px; text-align: center; padding: 12px;">
          <div>[[ date | momentDateFormat:'DD MMM' ]]</div>
          <div>[[ date | momentDateFormat:'YYYY' ]]</div>
        </div>
      </div>
      <div class="col-md-10">
        <div ng-show="getMetaDataFromMomentAndName(date, 'treatment_stop').length" class="row">
          <div class="col-md-1">
            <div style="background-color: black;  border-radius: 50%; height: 35px; width: 35px; text-align: center; padding: 6px;">
              <i style="color: white;" class="[[ getMetaDataFromMomentAndName(date, 'treatment_stop')[0].icon ]]"></i>
            </div>
          </div>
          <div class="col-md-11">
              <span ng-repeat="metaData in getMetaDataFromMomentAndName(date, 'treatment_stop')">
                <span ng-show="$first">Stopped Treatment of </span><a ng-click="editItem(metaData.subrecord)">[[ metaData.subrecord.drug ]]([[ metaData.subrecord.dose ]])</a><span ng-show="!$last">, </span>
              </span>
          </div>
        </div>

        <div ng-show="getMetaDataFromMomentAndName(date, 'treatment_start').length" class="row">
          <div class="col-md-1">
            <div  ng-hide="getMetaDataFromMomentAndName(date, 'treatment_stop').length" style="background-color: black;  border-radius: 50%; height: 35px; width: 35px; text-align: center; padding: 6px;">
              <i style="color: white;" class="[[ getMetaDataFromMomentAndName(date, 'treatment_start')[0].icon ]]"></i>
            </div>
          </div>
          <div class="col-md-11">
              <span ng-repeat="metaData in getMetaDataFromMomentAndName(date, 'treatment_start')">
                <span ng-show="$first">Started Treatment of </span><a ng-click="editItem(metaData.subrecord)">[[ metaData.subrecord.drug ]]([[ metaData.subrecord.dose ]])</a><span ng-show="!$last">, </span>
              </span>
          </div>
        </div>

        <div ng-show="getMetaDataFromMomentAndName(date, 'investigation').length" class="row">
          <div class="col-md-1">
            <div style="background-color: black;  border-radius: 50%; height: 35px; width: 35px; text-align: center; padding: 6px;">
              <i style="color: white;" class="[[ getMetaDataFromMomentAndName(date, 'investigation')[0].icon ]]"></i>
            </div>
          </div>
          <div class="col-md-11">
            <span ng-repeat="metaData in getMetaDataFromMomentAndName(date, 'investigation')">
                <span ng-show="$first">Tests of </span><a ng-click="editItem(metaData.subrecord)">[[ metaData.subrecord.test ]]</a><span ng-show="!$last">,</span>
              <span ng-show="$last"> ordered</span>
            </span>
          </div>
        </div>

        <div ng-show="getMetaDataFromMomentAndName(date, 'symptom_complex').length" class="row">
          <div class="col-md-1">
            <div style="background-color: black;  border-radius: 50%; height: 35px; width: 35px; text-align: center; padding: 6px;">
              <i style="color: white;" class="[[ getMetaDataFromMomentAndName(date, 'symptom_complex')[0].icon ]]"></i>
            </div>
          </div>
          <div class="col-md-11">
            <div ng-repeat="metaData in getMetaDataFromMomentAndName(date, 'symptom_complex')">
              <div ng-repeat="item in [metaData.subrecord]">
                <a ng-click="editItem(item)" ng-include src="metaData.templateUrl"></a>
              </div>
            </div>
          </div>
        </div>

        <div ng-show="getMetaDataFromMomentAndName(date, 'patient_consultation').length" class="row">
          <div class="col-md-1">
            <div style="background-color: black;  border-radius: 50%; height: 35px; width: 35px; text-align: center; padding: 6px;">
              <i style="color: white;" class="[[ getMetaDataFromMomentAndName(date, 'patient_consultation')[0].icon ]]"></i>
            </div>
          </div>
          <div class="col-md-11">
            <div ng-repeat="metaData in getMetaDataFromMomentAndName(date, 'patient_consultation')">
              <div ng-repeat="item in [metaData.subrecord]">
                <a ng-click="editItem(item)" ng-include src="metaData.templateUrl"></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
